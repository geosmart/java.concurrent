<!-- TOC -->

- [简介](#简介)
    - [并发简史](#并发简史)
        - [操作系统](#操作系统)
        - [进程](#进程)
        - [线程](#线程)
    - [线程的优势](#线程的优势)
        - [发挥多处理器的强大能力](#发挥多处理器的强大能力)
        - [建模的简单性](#建模的简单性)
    - [异步事件的简化处理](#异步事件的简化处理)
    - [响应更灵敏的用户界面](#响应更灵敏的用户界面)
    - [线程带来的风险](#线程带来的风险)
        - [安全性问题](#安全性问题)
        - [活跃性问题](#活跃性问题)
        - [性能问题](#性能问题)
    - [线程无处不在](#线程无处不在)

<!-- /TOC -->
# 简介
如何编写正确的并发程序...
##并发简史
### 操作系统
1. 早期计算机不含操作系统，每次只能运行１个程序;
2. 操作系统的出现使得计算机每次能运行多个程序，操作系统为各个独立的执行的进程分配资源，包括内存，文件句柄以及安全证书等，且在不同进程间可以通过一些`粗颗粒度`的通信机制（套接字、信号处理器、共享内存、文件）来交换数据。
### 进程
在计算机中加入操作系统来实现多个程序的同时进程的原因
1. 资源利用率：非阻塞；
2. 公平性：不同用户和程序共享计算机资源；
3. 便利性：多进程使得任务分而治之，且在必要时相互通信；更易于维护；

串行编程模型：每次只做一件事，简单直观
>但凡做事高效的人，总能在串行性与异步性之间找到平衡,对程序来说同样如此！
### 线程
对促使进程出现的因素同样促使着线程的出现。
1. 线程允许在同一个进程中出现多个程序控制流；
2. 线程会共享进程范围内的资源（如内存句柄和文件句柄），但每个程序都有各自的程序计数器，栈以及局部变量等
3. 线程提供了一种直观的分解模式来充分利用多处理器系统中的硬件并行性，在同一个进程中的多个线程也可以同时被调度到多个CPU上运行；
4. 线程也称为轻量级线程；
5. 大多数操作系统都是以线程作为基本的调度单位；
6. 由于同一个进程中的所有线程共享进程的内存空间，因此这些线程都能访问相同的变量，并在同一个堆上分配对象，这就需要一种比进程间共享数`据粒度更细`的数据共享机制；

## 线程的优势
### 发挥多处理器的强大能力
1. 多线程程序可以通过提高处理器资源的利用率来提升系统吞吐率；
2. 使用多个线程有助于在单处理器系统上获得更高的吞吐率；
### 建模的简单性
类比人类的工作方式：
1. 当只有1种任务在执行的时候，只需专注完成当前任务，不需琢磨下一步做什么；
>易于编写，错误更少，更容易测试
2. 如果需要完成多种类型的任务，那么需要管理不同任务之间的优先级和执行时间，并在任务之间进行切换，这将带来额外的开销；

软件同样如此：
1. 如果为模型中每种类型的任务都分配1个专门的线程，那么可以形成一种串行执行的假象；并将程序的执行逻辑与调度机制的细节，交替执行的操作，异步I/O以及资源等待等问题分离；
2. 通过使用线程，可以将复杂并且异步的工作流进一步分解为1组简单并且同步的工作流，每个工作流在1个单独的线程中运行，并在特定的同步位置进行交互；
>如Servlet和RMI，框架负责请求管理、线程创建、负载均衡，并在正确的时刻将请求分发给正确的应用程序组件。

## 异步事件的简化处理
1. 单线程服务器应用程序必须使用非阻塞I/O来处理并发；（难度大，易出错）
2. 当前操作系统线程数量已大大提升(理论可以设置为无限大，实际一般根据资源大小进行限制，如65535)
可在处理某个请求时单独分配1个线程；
## 响应更灵敏的用户界面
AWT,Swing的事件分发线程

## 线程带来的风险
### 安全性问题
### 活跃性问题
### 性能问题

## 线程无处不在
